"use strict";const btnSearch=document.querySelector(".js-btn"),inputSearch=document.querySelector(".js-input"),list=document.querySelector(".js-list"),favList=document.querySelector(".js-favourite"),textParagraph=document.querySelector(".js-results-search");let allCharacters=[],searchList=[],favCharacters=[],filterCharacters=[];function renderAllCharacters(e,t){t.innerHTML="";for(const a of e)renderCharacter(a,t);addCancelEvent(),e===favCharacters&&createReset()}function renderCharacter(e,t){const a=document.createElement("li"),r=document.createElement("article"),n=document.createElement("img"),s=document.createElement("h3"),c=document.createElement("h4");a.appendChild(r),r.appendChild(n),r.appendChild(s),r.appendChild(c),n.setAttribute("src",e.img),n.setAttribute("alt",""+e.name);const l=document.createTextNode(e.name),i=document.createTextNode(e.status);s.appendChild(l),c.appendChild(i),r.setAttribute("id",""+e.char_id),r.setAttribute("class","section__list__article"),n.setAttribute("class","section__list__article--img"),t.appendChild(a)}function handleSearch(e){e.preventDefault();const t=inputSearch.value;filterCharacters=allCharacters.filter(e=>e.name.toLowerCase().includes(t)),list.innerHTML="",renderAllCharacters(filterCharacters,list),addEvent(),markFavourites(),1===filterCharacters.length?textParagraph.innerHTML=`Hay ${filterCharacters.length} resultado de su búsqueda`:textParagraph.innerHTML=`Hay ${filterCharacters.length} resultados de su búsqueda`}function handleClickConsole(e){e.preventDefault();for(const e of[20,35,50,90])filterCharacters.length<e?console.log(`el número de resultados es ${filterCharacters.length} y es menor que ${e} `):console.log(`el número de resultados es ${filterCharacters.length} y es mayor que ${e} `)}function addEvent(){const e=document.querySelectorAll(".section__list__article");for(const t of e)t.classList.contains("aside__favourite__li--article")||t.addEventListener("click",handleFavourites)}function handleFavourites(e){e.preventDefault();const t=e.currentTarget;if(-1===searchInArray(parseInt(t.id)))t.classList.add("favourite"),favCharacters.push(allCharacters.find(e=>e.char_id===parseInt(t.id)));else{t.classList.remove("favourite");const e=searchInArray(parseInt(t.id));favCharacters.splice(e,1)}localStorage.setItem("favChar",JSON.stringify(favCharacters)),renderAllCharacters(favCharacters,favList)}function searchInArray(e){return favCharacters.findIndex(t=>t.char_id===e)}function markFavourites(){for(const e of favCharacters)document.getElementById(e.char_id).classList.add("favourite")}function handleCancel(e){handleFavourites(e),unmarkFavourites(e.currentTarget.id)}function unmarkFavourites(e){document.getElementById(e)&&document.getElementById(e).classList.remove("favourite")}function addCancelEvent(){if(favCharacters){let e=document.querySelectorAll(".aside__favourite li");for(let t of e){t.classList.add("aside__favourite__li");const e=document.createElement("div"),a=document.createElement("div"),r=document.createElement("span"),n=document.createTextNode("X"),s=document.createTextNode("borra de favoritos");e.appendChild(n),r.appendChild(s),a.appendChild(r),r.setAttribute("class","tooltip__cancel__span"),e.setAttribute("class","aside__favourite__li--div"),a.setAttribute("class","tooltip__cancel");let c=document.querySelectorAll(".aside__favourite__li article");for(const t of c)t.setAttribute("class","section__list__article aside__favourite__li--article"),t.appendChild(e),t.appendChild(a),e.setAttribute("id",""+t.id);let l=document.querySelectorAll(".aside__favourite__li--div");for(const e of l)e.addEventListener("click",handleCancel)}}}function createReset(){if(favCharacters.length>0){const e=document.createElement("button");e.setAttribute("class","js-btn-reset aside__favorite--reset"),favList.appendChild(e),e.innerHTML="Reset",e.addEventListener("click",handleResetAll)}else favList.innerHTML=""}function handleResetAll(){favList.innerHTML="";for(const e of favCharacters)unmarkFavourites(e.char_id);favCharacters=[],localStorage.setItem("favChar",JSON.stringify(favCharacters))}fetch("../assets/data/data.json").then(e=>e.json()).then(e=>{allCharacters=e,renderAllCharacters(allCharacters,list),addEvent(),localStorage.getItem("favChar")&&(favCharacters=JSON.parse(localStorage.getItem("favChar")),renderAllCharacters(favCharacters,favList),markFavourites())}),btnSearch.addEventListener("click",handleSearch),textParagraph.addEventListener("click",handleClickConsole);